==============================================
BiPo3 vertexes generation for simulation input
==============================================

This directory contains the configuration files needed
to define various vertex generators in the virtual geometry
of the Bipo3 detector.

 * Setup label is : ``bipo3::simulation::vertexes``
 * Setup version is : ``1.0``

Files
=====

 * ``README.rst`` : This file.
 * ``manager.conf`` : The main configuration file for the vertex generator manager
   used by the BiPo3 simulation application.
 * ``generators.lis`` :  The configuration parameters for a set of
   vertex generators used in the BiPo3 simulation.


Check the configuration
=======================

List the available vertex generators
------------------------------------

  1. First make sure the Bayeux software is installed and setup: ::

      $ which bxgenvtx_production
      ...

  2. Build Falaise from a build directory of your choice.
  3. Then from Falaise build directory (this is preliminary),
     print the list of available vertex generators: ::

        $ LD_LIBRARY_PATH="$(pwd)/BuildProducts/lib:${LD_LIBRARY_PATH}" \
          bxgenvtx_production \
           --logging "warning" \
           --load-dll Falaise \
           --datatools::resource-path "falaise@$(pwd)/BuildProducts/share/Falaise-1.0.0/resources" \
           --geometry-manager "@falaise:config/bipo3/geometry/2.0/manager.conf" \
           --vertex-generator-manager "@falaise:config/bipo3/simulation/vertexes/1.0/manager.conf" \
           --list
        List of vertex generators :
        |-- reflector_bulk  : Generate vertex in the bulk of the scintillator entrance window reflector
        |-- reflector_deposit  : Generate vertex on the front surface of the scintillator entrance window reflector
        |-- scintillator_bulk  : Generate vertex in the bulk of the scintillator block
        |-- scintillator_side_surfaces  : Generate vertex on the side surfaces of the scintillator block
        |-- source_bulk (current) : Generate vertex in the bulk volume of the source foil
        |-- source_surface_all  : Generate vertex on the surface of the source foil
        |-- source_surface_back  : Generate vertex on the back surface of the source foil
        `-- source_surface_front  : Generate vertex on the front surface of the source foil

Generate 10000 vertexes from the bulk volume of the source
----------------------------------------------------------

From the Falaise build directory, run: ::

        $ LD_LIBRARY_PATH="$(pwd)/BuildProducts/lib:${LD_LIBRARY_PATH}" \
          bxgenvtx_production \
           --logging "warning" \
           --load-dll Falaise \
           --datatools::resource-path "falaise@$(pwd)/BuildProducts/share/Falaise-1.0.0/resources" \
           --geometry-manager "@falaise:config/bipo3/geometry/2.0/manager.conf" \
           --vertex-generator-manager "@falaise:config/bipo3/simulation/vertexes/1.0/manager.conf" \
           --shoot \
           --prng-seed 314159 \
           --number-of-vertices 10000 \
           --vertex-generator "source_bulk" \
           --output-file "bipo3_source_bulk_vertices.txt" \
           --visu --visu-spot-zoom 2.0
        $ less bipo3_source_bulk_vertices.txt
        # generated by : genvtx_production
        #@geometry.setup.label=bipo3
        #@geometry.setup.version=2.0
        #@vertex_generator.name=source_bulk
        #@length_unit=mm
        -316.18806064222 -136.869268666022 -47.0752911741154
        -143.608610855415 -272.669734118506 -46.9979080122516
        539.644685304724 -299.035784194246 -47.0278023022397
        ...
